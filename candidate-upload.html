<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Télécharger votre CV - Nexten</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="fas fa-briefcase"></i> Nexten</h1>
            <nav>
                <ul>
                    <li><a href="index.html">Accueil</a></li>
                    <li><a href="post-job.html">Publier une offre</a></li>
                    <li><a href="candidate-upload.html" class="active">Espace candidat</a></li>
                    <li><a href="recruiter-dashboard.html">Espace recruteur</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <h2>Comment souhaitez-vous procéder ?</h2>
            <p>Vous pouvez télécharger votre CV maintenant ou commencer directement par le questionnaire.</p>
            
            <div class="form-card">
                <button class="btn btn-primary" id="uploadNowBtn">Télécharger mon CV</button>
                <a href="candidate-questionnaire.html" class="btn btn-secondary">Aller au questionnaire</a>
            </div>
            
            <div id="uploadContent" style="display: none;">
                <label for="cvUpload">Téléchargez votre CV :</label>
                <input type="file" id="cvUpload" accept=".pdf,.docx,.doc">
                <div id="progressContainer" style="display: none;">
                    <div id="progressFill" style="width: 0%;"></div>
                    <div id="progressText">0%</div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>© 2025 Nexten - Tous droits réservés</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const uploadNowBtn = document.getElementById('uploadNowBtn');
            const cvUpload = document.getElementById('cvUpload');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const progressContainer = document.getElementById('progressContainer');
            const uploadContent = document.getElementById('uploadContent');

            uploadNowBtn.addEventListener('click', function() {
                uploadContent.style.display = 'block';
            });

            cvUpload.addEventListener('change', async function(e) {
                const file = e.target.files[0];
                if (!file) return;

                if (file.size > 5 * 1024 * 1024) {
                    alert('Le fichier est trop volumineux. Taille maximum : 5 Mo');
                    cvUpload.value = '';
                    return;
                }

                progressContainer.style.display = 'block';
                simulateUploadWithAnimation();
            });

            function simulateUploadWithAnimation() {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 20;
                    progressFill.style.width = `${progress}%`;
                    progressText.textContent = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => saveExtractedData({
                            personalInfo: {
                                name: "John Doe",
                                email: "john@example.com",
                                phone: "0123456789",
                                location: "Paris, France"
                            },
                            skills: ["JavaScript", "HTML", "CSS", "React"],
                            experience: {
                                company: "TechCorp",
                                duration: "3 ans"
                            },
                            education: {
                                degree: "Master Informatique",
                                school: "Université de Paris",
                                year: "2020"
                            }
                        }), 500);
                    }
                }, 500);
            }

            function saveExtractedData(extractedData) {
                try {
                    localStorage.setItem('candidateData', JSON.stringify(extractedData));
                    console.log('CV data saved:', extractedData);

                    const questionnaireBtn = document.createElement('button');
                    questionnaireBtn.textContent = 'Accéder au questionnaire';
                    questionnaireBtn.className = 'btn btn-primary';
                    questionnaireBtn.addEventListener('click', function() {
                        window.location.href = 'candidate-questionnaire.html';
                    });

                    progressContainer.innerHTML = '';
                    progressContainer.appendChild(questionnaireBtn);
                } catch (error) {
                    console.error('Erreur lors de la sauvegarde des données:', error);
                    alert('Une erreur est survenue lors de la sauvegarde des données');
                }
            }
        });
    </script>
</body>
</html>