<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offres recommandées - Nexten</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .matches-section {
            padding: 4rem 0;
        }
        
        .matches-intro {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .matches-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .match-card {
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .match-score {
            position: absolute;
            top: 0;
            right: 0;
            background-color: var(--primary);
            color: white;
            padding: 0.5rem 1rem;
            font-weight: 600;
            border-bottom-left-radius: var(--radius);
        }
        
        .match-company-logo {
            width: 80px;
            height: 80px;
            min-width: 80px;
            background-color: #f8fafc;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1.5rem;
        }
        
        .company-initial {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .match-content {
            flex: 1;
        }
        
        .match-header {
            margin-bottom: 1rem;
        }
        
        .match-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.3rem;
        }
        
        .match-company {
            font-size: 1rem;
            color: var(--text);
            display: flex;
            align-items: center;
            margin-bottom: 0.3rem;
        }
        
        .match-company i {
            margin-right: 0.5rem;
            color: var(--primary);
        }
        
        .match-location {
            font-size: 0.9rem;
            color: var(--text);
            display: flex;
            align-items: center;
        }
        
        .match-location i {
            margin-right: 0.5rem;
            color: #e74c3c;
        }
        
        .match-body {
            margin-bottom: 1rem;
        }
        
        .match-description {
            color: var(--text);
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }
        
        .match-salary {
            font-weight: 500;
            color: var(--dark);
            display: flex;
            align-items: center;
        }
        
        .match-salary i {
            margin-right: 0.5rem;
            color: var(--success);
        }
        
        .match-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #f1f5f9;
        }
        
        .match-tags {
            display: flex;
            flex-wrap: wrap;
        }
        
        .match-tag {
            background-color: rgba(108, 99, 255, 0.1);
            color: var(--primary);
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .match-tag.highlight {
            background-color: rgba(108, 99, 255, 0.2);
            border: 1px solid var(--primary);
        }
        
        .apply-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: var(--radius);
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .apply-btn:hover {
            background-color: var(--primary-dark);
        }
        
        .matches-summary {
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .summary-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .summary-title i {
            margin-right: 0.5rem;
            color: var(--primary);
        }
        
        .summary-skills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .highlight-section {
            background-color: rgba(108, 99, 255, 0.05);
            border-radius: var(--radius);
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .highlight-title {
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
        }
        
        .highlight-text {
            font-size: 0.95rem;
            color: var(--text);
            line-height: 1.5;
        }
        
        .no-matches {
            text-align: center;
            background-color: white;
            padding: 3rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
        }
        
        .no-matches i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .no-matches h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }
        
        .match-type {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            background-color: #3498db;
            color: white;
            padding: 0.3rem 0.7rem;
            font-size: 0.8rem;
            border-radius: 20px;
            font-weight: 500;
        }
        
        .upload-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3rem;
        }
        
        .upload-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 30%;
            text-align: center;
            position: relative;
        }
        
        .upload-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 25px;
            right: -40%;
            width: 80%;
            height: 2px;
            background-color: #e2e8f0;
        }
        
        .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #f8fafc;
            border: 2px solid #e2e8f0;
            color: var(--text);
            font-weight: 600;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        
        .step-title {
            font-weight: 500;
            color: var(--text);
        }
        
        .upload-step.active .step-number {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        
        .upload-step.active .step-title {
            color: var(--primary);
            font-weight: 600;
        }
        
        .upload-step.completed .step-number {
            background-color: var(--success);
            border-color: var(--success);
            color: white;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="fas fa-briefcase"></i> Nexten</h1>
            <nav>
                <ul>
                    <li><a href="index.html">Accueil</a></li>
                    <li><a href="post-job.html">Publier une offre</a></li>
                    <li><a href="candidate-upload.html" class="active">Espace candidat</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="matches-section">
        <div class="container">
            <div class="upload-steps">
                <div class="upload-step completed">
                    <div class="step-number"><i class="fas fa-check"></i></div>
                    <div class="step-title">Upload CV</div>
                </div>
                <div class="upload-step completed">
                    <div class="step-number"><i class="fas fa-check"></i></div>
                    <div class="step-title">Questionnaire</div>
                </div>
                <div class="upload-step active">
                    <div class="step-number">3</div>
                    <div class="step-title">Matching</div>
                </div>
            </div>
        
            <div class="matches-intro">
                <h2>Vos offres d'emploi recommandées</h2>
                <p class="section-description">Voici les 10 meilleures offres correspondant à votre profil, analysées et sélectionnées spécialement pour vous.</p>
            </div>
            
            <div class="matches-container">
                <div class="matches-summary">
                    <h3 class="summary-title"><i class="fas fa-user-check"></i> Votre profil</h3>
                    <div class="info-item">
                        <div class="info-label">Nom :</div>
                        <div class="info-value">John Doe</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Expérience :</div>
                        <div class="info-value">Développeur Frontend (3 ans)</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Localisation :</div>
                        <div class="info-value">Paris, France</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Préférences :</div>
                        <div class="info-value">CDI, Télétravail partiel, Tech</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Compétences :</div>
                    </div>
                    <div class="summary-skills">
                        <span class="skill-tag">JavaScript</span>
                        <span class="skill-tag">React</span>
                        <span class="skill-tag">Node.js</span>
                        <span class="skill-tag">HTML5</span>
                        <span class="skill-tag">CSS3</span>
                        <span class="skill-tag">Git</span>
                        <span class="skill-tag">TypeScript</span>
                        <span class="skill-tag">MongoDB</span>
                    </div>
                    
                    <div class="highlight-section">
                        <h4 class="highlight-title">Comment nous avons sélectionné ces offres</h4>
                        <p class="highlight-text">Notre algorithme a identifié les offres qui correspondent le mieux à vos compétences, votre expérience et vos préférences. En combinant les données de votre CV et vos réponses au questionnaire, nous avons pu créer un profil complet qui nous a permis de vous proposer les offres les plus pertinentes pour vous.</p>
                    </div>
                </div>
                
                <!-- Liste des offres recommandées -->
                <div class="match-card">
                    <div class="match-score">95% Match</div>
                    <div class="match-type">CDI</div>
                    <div class="match-company-logo">
                        <span class="company-initial">T</span>
                    </div>
                    <div class="match-content">
                        <div class="match-header">
                            <h3 class="match-title">Développeur Frontend React</h3>
                            <div class="match-company"><i class="fas fa-building"></i> TechSolutions</div>
                            <div class="match-location"><i class="fas fa-map-marker-alt"></i> Paris, France</div>
                        </div>
                        <div class="match-body">
                            <div class="match-description">Nous recherchons un développeur frontend React expérimenté pour rejoindre notre équipe et participer au développement de nouvelles fonctionnalités pour notre plateforme SaaS...</div>
                            <div class="match-salary"><i class="fas fa-money-bill-wave"></i> 45 000 € - 60 000 € / an</div>
                        </div>
                        <div class="match-footer">
                            <div class="match-tags">
                                <span class="match-tag highlight">React</span>
                                <span class="match-tag highlight">JavaScript</span>
                                <span class="match-tag highlight">TypeScript</span>
                                <span class="match-tag highlight">HTML5</span>
                                <span class="match-tag highlight">CSS3</span>
                                <span class="match-tag">Redux</span>
                            </div>
                            <button class="apply-btn">Postuler</button>
                        </div>
                    </div>
                </div>
                
                <div class="match-card">
                    <div class="match-score">90% Match</div>
                    <div class="match-type">Télétravail</div>
                    <div class="match-company-logo">
                        <span class="company-initial">D</span>
                    </div>
                    <div class="match-content">
                        <div class="match-header">
                            <h3 class="match-title">Développeur Full Stack JavaScript</h3>
                            <div class="match-company"><i class="fas fa-building"></i> DigitalCraft</div>
                            <div class="match-location"><i class="fas fa-map-marker-alt"></i> Remote</div>
                        </div>
                        <div class="match-body">
                            <div class="match-description">Rejoignez notre équipe internationale pour développer des applications web modernes utilisant React, Node.js et MongoDB. Vous travaillerez en télétravail complet avec une équipe dynamique...</div>
                            <div class="match-salary"><i class="fas fa-money-bill-wave"></i> 50 000 € - 65 000 € / an</div>
                        </div>
                        <div class="match-footer">
                            <div class="match-tags">
                                <span class="match-tag highlight">React</span>
                                <span class="match-tag highlight">Node.js</span>
                                <span class="match-tag highlight">JavaScript</span>
                                <span class="match-tag highlight">MongoDB</span>
                                <span class="match-tag">Express</span>
                            </div>
                            <button class="apply-btn">Postuler</button>
                        </div>
                    </div>
                </div>
                
                <div class="match-card">
                    <div class="match-score">85% Match</div>
                    <div class="match-type">CDI</div>
                    <div class="match-company-logo">
                        <span class="company-initial">I</span>
                    </div>
                    <div class="match-content">
                        <div class="match-header">
                            <h3 class="match-title">Développeur Frontend Angular/React</h3>
                            <div class="match-company"><i class="fas fa-building"></i> InnovateX</div>
                            <div class="match-location"><i class="fas fa-map-marker-alt"></i> Lyon, France</div>
                        </div>
                        <div class="match-body">
                            <div class="match-description">Nous cherchons un développeur frontend pour travailler sur des projets innovants dans le domaine de la fintech. Expérience avec React ou Angular requise...</div>
                            <div class="match-salary"><i class="fas fa-money-bill-wave"></i> 42 000 € - 55 000 € / an</div>
                        </div>
                        <div class="match-footer">
                            <div class="match-tags">
                                <span class="match-tag highlight">JavaScript</span>
                                <span class="match-tag highlight">React</span>
                                <span class="match-tag">Angular</span>
                                <span class="match-tag highlight">CSS3</span>
                                <span class="match-tag highlight">HTML5</span>
                            </div>
                            <button class="apply-btn">Postuler</button>
                        </div>
                    </div>
                </div>
                
                <div class="match-card">
                    <div class="match-score">82% Match</div>
                    <div class="match-type">Freelance</div>
                    <div class="match-company-logo">
                        <span class="company-initial">W</span>
                    </div>
                    <div class="match-content">
                        <div class="match-header">
                            <h3 class="match-title">Développeur React Native</h3>
                            <div class="match-company"><i class="fas fa-building"></i> WebMobile</div>
                            <div class="match-location"><i class="fas fa-map-marker-alt"></i> Nantes, France</div>
                        </div>
                        <div class="match-body">
                            <div class="match-description">Recherche un développeur React Native pour un projet de 6 mois visant à créer une application mobile pour le secteur de la santé...</div>
                            <div class="match-salary"><i class="fas fa-money-bill-wave"></i> 450 € - 550 € / jour</div>
                        </div>
                        <div class="match-footer">
                            <div class="match-tags">
                                <span class="match-tag highlight">JavaScript</span>
                                <span class="match-tag">React Native</span>
                                <span class="match-tag highlight">React</span>
                                <span class="match-tag">Mobile</span>
                                <span class="match-tag highlight">Git</span>
                            </div>
                            <button class="apply-btn">Postuler</button>
                        </div>
                    </div>
                </div>
                
                <div class="match-card">
                    <div class="match-score">78% Match</div>
                    <div class="match-type">CDI</div>
                    <div class="match-company-logo">
                        <span class="company-initial">C</span>
                    </div>
                    <div class="match-content">
                        <div class="match-header">
                            <h3 class="match-title">Développeur Frontend Vue.js</h3>
                            <div class="match-company"><i class="fas fa-building"></i> CloudTech</div>
                            <div class="match-location"><i class="fas fa-map-marker-alt"></i> Bordeaux, France</div>
                        </div>
                        <div class="match-body">
                            <div class="match-description">Rejoignez notre équipe pour développer des interfaces utilisateur avancées pour notre solution cloud. Expérience en Vue.js appréciée, mais nous acceptons les développeurs React prêts à apprendre...</div>
                            <div class="match-salary"><i class="fas fa-money-bill-wave"></i> 40 000 € - 55 000 € / an</div>
                        </div>
                        <div class="match-footer">
                            <div class="match-tags">
                                <span class="match-tag">Vue.js</span>
                                <span class="match-tag highlight">JavaScript</span>
                                <span class="match-tag highlight">HTML5</span>
                                <span class="match-tag highlight">CSS3</span>
                                <span class="match-tag">Vuex</span>
                            </div>
                            <button class="apply-btn">Postuler</button>
                        </div>
                    </div>
                </div>
                
                <!-- Ajouter d'autres cartes d'offres jusqu'à 10 au total -->
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2025 Nexten - Tous droits réservés</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Récupérer les données du candidat depuis localStorage
            const candidateData = JSON.parse(localStorage.getItem('candidateData') || '{}');
            const questionnaireData = JSON.parse(localStorage.getItem('candidateQuestionnaire') || '{}');
            
            console.log('Données du CV:', candidateData);
            console.log('Données du questionnaire:', questionnaireData);
            
            // Mise à jour du profil candidat avec les données du questionnaire
            updateCandidateProfile(candidateData, questionnaireData);
            
            // Simuler la génération des offres correspondantes
            generateMatchingJobs(candidateData, questionnaireData);
            
            // Ajouter des effets aux boutons de candidature
            document.querySelectorAll('.apply-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Référence à la carte de correspondance
                    const matchCard = this.closest('.match-card');
                    const jobTitle = matchCard.querySelector('.match-title').textContent;
                    const companyName = matchCard.querySelector('.match-company').textContent.replace('Entreprise : ', '');
                    
                    this.innerHTML = '<i class="fas fa-check"></i> Candidature envoyée';
                    this.style.backgroundColor = 'var(--success)';
                    this.disabled = true;
                    
                    // Ajouter une animation de succès
                    matchCard.style.borderLeft = '5px solid var(--success)';
                    matchCard.style.transition = 'all 0.3s ease';
                    
                    // Simuler l'envoi de la candidature
                    setTimeout(() => {
                        // Créer une notification sophistiquée
                        const notification = document.createElement('div');
                        notification.className = 'notification success';
                        notification.innerHTML = `
                            <div class="notification-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="notification-content">
                                <div class="notification-title">Candidature envoyée avec succès !</div>
                                <div class="notification-message">Votre candidature pour le poste "${jobTitle}" chez ${companyName} a bien été transmise.</div>
                            </div>
                            <div class="notification-close"><i class="fas fa-times"></i></div>
                        `;
                        
                        // Styles pour la notification
                        notification.style.position = 'fixed';
                        notification.style.bottom = '20px';
                        notification.style.right = '20px';
                        notification.style.backgroundColor = 'white';
                        notification.style.boxShadow = 'var(--shadow-lg)';
                        notification.style.borderRadius = 'var(--radius)';
                        notification.style.padding = '1rem';
                        notification.style.display = 'flex';
                        notification.style.alignItems = 'flex-start';
                        notification.style.maxWidth = '400px';
                        notification.style.zIndex = '1000';
                        notification.style.transform = 'translateY(100px)';
                        notification.style.opacity = '0';
                        notification.style.transition = 'all 0.5s ease';
                        
                        // Styles pour l'icône
                        notification.querySelector('.notification-icon').style.marginRight = '1rem';
                        notification.querySelector('.notification-icon i').style.color = 'var(--success)';
                        notification.querySelector('.notification-icon i').style.fontSize = '1.5rem';
                        
                        // Styles pour le contenu
                        notification.querySelector('.notification-title').style.fontWeight = '600';
                        notification.querySelector('.notification-title').style.marginBottom = '0.3rem';
                        
                        // Styles pour le bouton de fermeture
                        notification.querySelector('.notification-close').style.marginLeft = '1rem';
                        notification.querySelector('.notification-close').style.cursor = 'pointer';
                        notification.querySelector('.notification-close i').style.color = 'var(--text)';
                        
                        // Ajouter la notification au document
                        document.body.appendChild(notification);
                        
                        // Animer l'apparition
                        setTimeout(() => {
                            notification.style.transform = 'translateY(0)';
                            notification.style.opacity = '1';
                        }, 100);
                        
                        // Fermer la notification au clic
                        notification.querySelector('.notification-close').addEventListener('click', function() {
                            notification.style.transform = 'translateY(100px)';
                            notification.style.opacity = '0';
                            setTimeout(() => notification.remove(), 500);
                        });
                        
                        // Auto-fermeture après 5 secondes
                        setTimeout(() => {
                            notification.style.transform = 'translateY(100px)';
                            notification.style.opacity = '0';
                            setTimeout(() => notification.remove(), 500);
                        }, 5000);
                    }, 800);
                });
            });
        });
        
        // Fonction pour mettre à jour le profil du candidat
        function updateCandidateProfile(cvData, questionnaireData) {
            const profileSection = document.querySelector('.matches-summary');
            if (!profileSection) return;
            
            // Nom du candidat
            let candidateName = "Candidat";
            if (cvData.personalInfo && cvData.personalInfo.name) {
                candidateName = cvData.personalInfo.name;
            } else if (questionnaireData.fullname) {
                candidateName = questionnaireData.fullname;
            }
            
            // Expérience
            let experience = "Non spécifié";
            if (cvData.experience && cvData.experience.company) {
                experience = `${cvData.experience.company} (${cvData.experience.duration || "Durée non spécifiée"})`;
            }
            
            // Localisation
            let location = "Non spécifiée";
            if (cvData.personalInfo && cvData.personalInfo.location) {
                location = cvData.personalInfo.location;
            } else if (questionnaireData.address) {
                location = questionnaireData.address;
            }
            
            // Compétences
            let skills = [];
            if (cvData.skills && Array.isArray(cvData.skills)) {
                skills = cvData.skills;
            }
            
            // Préférences
            let preferences = [];
            if (questionnaireData["commute-time"]) {
                preferences.push(`Trajet max: ${questionnaireData["commute-time"]}`);
            }
            if (questionnaireData["workspace-type"]) {
                preferences.push(questionnaireData["workspace-type"]);
            }
            if (questionnaireData["company-structure"] && Array.isArray(questionnaireData["company-structure"])) {
                preferences.push(questionnaireData["company-structure"].join(", "));
            }
            
            // Mise à jour du HTML
            const infoItems = profileSection.querySelectorAll('.info-item');
            if (infoItems.length >= 4) {
                // Nom
                infoItems[0].querySelector('.info-value').textContent = candidateName;
                
                // Expérience
                infoItems[1].querySelector('.info-value').textContent = experience;
                
                // Localisation
                infoItems[2].querySelector('.info-value').textContent = location;
                
                // Préférences
                infoItems[3].querySelector('.info-value').textContent = preferences.length > 0 ? preferences.join(', ') : "Non spécifiées";
            }
            
            // Mise à jour des compétences
            const skillsContainer = profileSection.querySelector('.summary-skills');
            if (skillsContainer) {
                skillsContainer.innerHTML = '';
                
                if (skills.length > 0) {
                    skills.forEach(skill => {
                        const skillTag = document.createElement('span');
                        skillTag.className = 'skill-tag';
                        skillTag.textContent = skill;
                        skillsContainer.appendChild(skillTag);
                    });
                } else {
                    skillsContainer.innerHTML = '<span class="skill-tag">Non spécifiées</span>';
                }
            }
        }
        
        // Fonction pour générer les offres d'emploi correspondantes
        function generateMatchingJobs(cvData, questionnaireData) {
            const jobsContainer = document.querySelector('.matches-container');
            if (!jobsContainer) return;
            
            // Supprimer les cartes d'offres existantes (sauf le résumé du profil)
            const existingCards = jobsContainer.querySelectorAll('.match-card');
            existingCards.forEach(card => card.remove());
            
            // Collecter les informations pertinentes du candidat pour le matching
            // Vérifier si nous avons des données enrichies par le parser avancé
            const hasEnrichedData = candidateData.parsedData && candidateData.matchingTags;
            
            let candidateSkills = [];
            let preferredLocation = "France";
            let salaryRange = "";
            let workspaceType = "";
            
            if (hasEnrichedData) {
                console.log("Utilisation des données enrichies par le parser avancé");
                // Utiliser les données normalisées du parser avancé
                const parsedData = candidateData.parsedData;
                
                // Récupérer les compétences normalisées
                candidateSkills = parsedData.skills?.normalized?.technicalSkills || cvData.skills || [];
                
                // Récupérer la localisation
                preferredLocation = parsedData.jobPreferences?.normalized?.location || 
                                  ((questionnaireData.address || "").includes("Paris") ? "Paris" : 
                                   (questionnaireData.address || "").includes("Lyon") ? "Lyon" :
                                   (questionnaireData.address || "").includes("Marseille") ? "Marseille" : "France");
                
                // Récupérer le salaire
                const salaryData = parsedData.jobPreferences?.normalized?.salaryExpectation || {};
                salaryRange = salaryData.min && salaryData.max ? 
                            `${salaryData.min/1000}-${salaryData.max/1000}k` : 
                            questionnaireData["salary-range"] || "";
                
                // Récupérer la préférence de travail
                workspaceType = parsedData.jobPreferences?.normalized?.remotePreference || 
                              questionnaireData["workspace-type"] || "";
            } else {
                // Fallback sur les données standards
                candidateSkills = cvData.skills || [];
                preferredLocation = (questionnaireData.address || "").includes("Paris") ? "Paris" : 
                                    (questionnaireData.address || "").includes("Lyon") ? "Lyon" :
                                    (questionnaireData.address || "").includes("Marseille") ? "Marseille" : "France";
                salaryRange = questionnaireData["salary-range"] || "";
                workspaceType = questionnaireData["workspace-type"] || "";
            }
            
            const desiredJobTitles = questionnaireData["job-titles"] || [];
            const commuteTime = questionnaireData["commute-time"] || "30 min";
            const preferredSectors = questionnaireData["preferred-sectors"] || [];
            
            // Liste fictive d'offres d'emploi
            const jobs = [
                {
                    title: "Développeur Frontend React",
                    company: "TechSolutions",
                    location: "Paris, France",
                    description: "Nous recherchons un développeur frontend React expérimenté pour rejoindre notre équipe et participer au développement de nouvelles fonctionnalités pour notre plateforme SaaS...",
                    salary: "45 000 € - 60 000 € / an",
                    type: "CDI",
                    tags: ["React", "JavaScript", "TypeScript", "HTML5", "CSS3", "Redux"],
                    score: 95
                },
                {
                    title: "Développeur Full Stack JavaScript",
                    company: "DigitalCraft",
                    location: "Remote",
                    description: "Rejoignez notre équipe internationale pour développer des applications web modernes utilisant React, Node.js et MongoDB. Vous travaillerez en télétravail complet avec une équipe dynamique...",
                    salary: "50 000 € - 65 000 € / an",
                    type: "Télétravail",
                    tags: ["React", "Node.js", "JavaScript", "MongoDB", "Express"],
                    score: 90
                },
                {
                    title: "Développeur Frontend Angular/React",
                    company: "InnovateX",
                    location: "Lyon, France",
                    description: "Nous cherchons un développeur frontend pour travailler sur des projets innovants dans le domaine de la fintech. Expérience avec React ou Angular requise...",
                    salary: "42 000 € - 55 000 € / an",
                    type: "CDI",
                    tags: ["JavaScript", "React", "Angular", "CSS3", "HTML5"],
                    score: 85
                },
                {
                    title: "Développeur React Native",
                    company: "WebMobile",
                    location: "Nantes, France",
                    description: "Recherche un développeur React Native pour un projet de 6 mois visant à créer une application mobile pour le secteur de la santé...",
                    salary: "450 € - 550 € / jour",
                    type: "Freelance",
                    tags: ["JavaScript", "React Native", "React", "Mobile", "Git"],
                    score: 82
                },
                {
                    title: "Développeur Frontend Vue.js",
                    company: "CloudTech",
                    location: "Bordeaux, France",
                    description: "Rejoignez notre équipe pour développer des interfaces utilisateur avancées pour notre solution cloud. Expérience en Vue.js appréciée, mais nous acceptons les développeurs React prêts à apprendre...",
                    salary: "40 000 € - 55 000 € / an",
                    type: "CDI",
                    tags: ["Vue.js", "JavaScript", "HTML5", "CSS3", "Vuex"],
                    score: 78
                },
                {
                    title: "Ingénieur Frontend",
                    company: "FinTech Solutions",
                    location: "Paris, France",
                    description: "Nous recherchons un ingénieur frontend pour notre équipe produit qui travaillera sur notre plateforme de services financiers. Vous serez responsable du développement et de la maintenance de l'interface utilisateur...",
                    salary: "48 000 € - 60 000 € / an",
                    type: "CDI",
                    tags: ["JavaScript", "React", "TypeScript", "Redux", "REST API"],
                    score: 75
                },
                {
                    title: "Développeur Web React",
                    company: "E-Commerce Plus",
                    location: "Lille, France",
                    description: "Rejoignez une équipe dynamique pour développer et améliorer notre plateforme e-commerce de nouvelle génération...",
                    salary: "40 000 € - 50 000 € / an",
                    type: "CDI",
                    tags: ["React", "JavaScript", "CSS3", "eCommerce", "Responsive Design"],
                    score: 73
                },
                {
                    title: "Développeur Frontend Senior",
                    company: "MediaGroup",
                    location: "Marseille, France",
                    description: "Nous recherchons un développeur frontend senior pour diriger notre équipe web et contribuer à la refonte de notre plateforme de contenu digital...",
                    salary: "55 000 € - 70 000 € / an",
                    type: "CDI",
                    tags: ["JavaScript", "React", "HTML5", "CSS3", "Leadership"],
                    score: 70
                },
                {
                    title: "Développeur JavaScript",
                    company: "StartupX",
                    location: "Remote, France",
                    description: "Startup en forte croissance recherche un développeur JavaScript polyvalent pour participer au développement de notre produit SaaS B2B. Télétravail possible à 100%...",
                    salary: "45 000 € - 55 000 € / an",
                    type: "Télétravail",
                    tags: ["JavaScript", "ES6", "React", "Node.js", "SaaS"],
                    score: 67
                },
                {
                    title: "Développeur UI/UX",
                    company: "DesignTech",
                    location: "Toulouse, France",
                    description: "Nous recherchons un développeur frontend avec de bonnes connaissances en design UI/UX pour créer des interfaces utilisateur modernes et accessibles...",
                    salary: "38 000 € - 48 000 € / an",
                    type: "CDI",
                    tags: ["JavaScript", "UI/UX", "HTML5", "CSS3", "Design"],
                    score: 65
                }
            ];
            
            // Fonction pour calculer le score de correspondance réel en fonction du profil candidat
            function calculateRealScore(job) {
                let score = job.score; // Score initial
                
                // Ajustement en fonction de la localisation
                if (job.location.includes(preferredLocation)) {
                    score += 5;
                }
                
                // Ajustement en fonction des compétences
                let skillMatchCount = 0;
                job.tags.forEach(tag => {
                    if (candidateSkills.includes(tag)) {
                        skillMatchCount++;
                    }
                });
                
                // Bonus pour un bon taux de correspondance de compétences
                if (skillMatchCount > 0 && job.tags.length > 0) {
                    const skillMatchRate = skillMatchCount / job.tags.length;
                    score += skillMatchRate * 10;
                }
                
                // Ajustement en fonction du type de poste (CDI, télétravail, etc.)
                if (workspaceType !== "Peu importe") {
                    if (workspaceType === "Open Space" && job.type === "Télétravail") {
                        score -= 5; // Pénalité si préférence pour open space mais télétravail proposé
                    } else if (workspaceType === "Bureau fermé" && job.type !== "Télétravail") {
                        score -= 3; // Légère pénalité
                    }
                }
                
                // Normaliser le score entre 0 et 100
                return Math.min(Math.max(Math.round(score), 0), 100);
            }
            
            // Trier les offres d'emploi en fonction du score ajusté
            jobs.forEach(job => {
                job.adjustedScore = calculateRealScore(job);
            });
            
            jobs.sort((a, b) => b.adjustedScore - a.adjustedScore);
            
            // Créer les cartes d'offres
            jobs.forEach(job => {
                const matchCard = document.createElement('div');
                matchCard.className = 'match-card';
                
                // Déterminer si une compétence du candidat correspond à une compétence requise
                const matchingTags = job.tags.map(tag => {
                    return {
                        tag: tag,
                        isMatch: candidateSkills.includes(tag)
                    };
                });
                
                matchCard.innerHTML = `
                    <div class="match-score">${job.adjustedScore}% Match</div>
                    <div class="match-type">${job.type}</div>
                    <div class="match-company-logo">
                        <span class="company-initial">${job.company.charAt(0)}</span>
                    </div>
                    <div class="match-content">
                        <div class="match-header">
                            <h3 class="match-title">${job.title}</h3>
                            <div class="match-company"><i class="fas fa-building"></i> ${job.company}</div>
                            <div class="match-location"><i class="fas fa-map-marker-alt"></i> ${job.location}</div>
                        </div>
                        <div class="match-body">
                            <div class="match-description">${job.description}</div>
                            <div class="match-salary"><i class="fas fa-money-bill-wave"></i> ${job.salary}</div>
                        </div>
                        <div class="match-footer">
                            <div class="match-tags">
                                ${matchingTags.map(item => `
                                    <span class="match-tag ${item.isMatch ? 'highlight' : ''}">${item.tag}</span>
                                `).join('')}
                            </div>
                            <button class="apply-btn">Postuler</button>
                        </div>
                    </div>
                `;
                
                jobsContainer.appendChild(matchCard);
            });
        }
    </script>
</body>
</html>