<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sélection des candidats - Nexten</title>
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="../components/header.js"></script>
    <script src="../components/footer.js"></script>
    <style>
        /* Styles spécifiques à la page de sélection des candidats */
        .selection-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .intro-section {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .intro-section h1 {
            color: var(--dark);
            font-size: 2.2rem;
            margin-bottom: 1rem;
        }
        
        .intro-section p {
            color: var(--text);
            max-width: 800px;
            margin: 0 auto 1.5rem;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .progress-container {
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
        }
        
        .progress-steps {
            display: flex;
            align-items: center;
            position: relative;
            max-width: 800px;
        }
        
        .progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            height: 3px;
            width: 100%;
            background-color: #e2e8f0;
            z-index: 0;
        }
        
        .progress-line {
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            height: 3px;
            width: 75%;
            background-color: var(--primary);
            z-index: 1;
            transition: width 0.5s ease;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            padding: 0 2rem;
        }
        
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: white;
            border: 3px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.8rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .step-text {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text);
            text-align: center;
        }
        
        .step.completed .step-circle {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        
        .step.active .step-circle {
            border-color: var(--primary);
            color: var(--primary);
            transform: scale(1.1);
            box-shadow: 0 0 0 5px rgba(108, 99, 255, 0.2);
        }
        
        .step.completed .step-text,
        .step.active .step-text {
            color: var(--primary);
            font-weight: 600;
        }

        /* Section profil de l'offre d'emploi */
        .job-section {
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .job-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }

        .company-logo {
            width: 80px;
            height: 80px;
            border-radius: 15px;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 600;
            margin-right: 1.5rem;
            flex-shrink: 0;
        }

        .job-info {
            flex: 1;
        }

        .job-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .company-name {
            font-size: 1.2rem;
            color: var(--text);
            margin-bottom: 1rem;
        }

        .job-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            color: var(--text);
            font-size: 0.95rem;
        }

        .meta-item i {
            color: var(--primary);
            margin-right: 0.5rem;
        }

        .job-skills {
            margin-top: 1.5rem;
        }

        .job-skills h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
        }

        .skill-tag {
            background-color: rgba(108, 99, 255, 0.1);
            color: var(--primary);
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Compteur de sélection */
        .selection-counter {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
        }

        .counter-text {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .counter {
            background-color: white;
            color: var(--primary);
            border-radius: 20px;
            padding: 0.3rem 1rem;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: var(--shadow-sm);
        }

        /* Section des candidats */
        .candidates-section {
            margin-bottom: 3rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .candidate-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .filter-select {
            padding: 0.6rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: var(--radius);
            min-width: 180px;
            font-size: 0.95rem;
        }

        .candidates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .candidate-card {
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .candidate-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .candidate-card.selected {
            border-color: var(--primary);
            background-color: rgba(108, 99, 255, 0.05);
        }

        .match-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: var(--dark);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 2;
        }

        .match-badge.high {
            background-color: #10b981;
        }

        .match-badge.medium {
            background-color: #f59e0b;
        }
        
        .candidate-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            position: relative;
            display: flex;
            align-items: center;
        }

        .candidate-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 600;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .candidate-header-info {
            flex: 1;
        }

        .candidate-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .candidate-title {
            font-size: 1rem;
            color: var(--text);
            margin-bottom: 0.8rem;
        }

        .candidate-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .candidate-tag {
            background-color: var(--light);
            color: var(--text);
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
        }

        .candidate-tag i {
            margin-right: 0.3rem;
            font-size: 0.8rem;
        }

        .candidate-body {
            padding: 1.5rem;
        }

        .candidate-skills {
            margin-bottom: 1.2rem;
        }

        .candidate-skills .section-subtitle {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.8rem;
        }

        .candidate-skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .candidate-skill-tag {
            background-color: var(--light);
            color: var(--text);
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.85rem;
        }

        .candidate-skill-tag.match {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
            font-weight: 500;
        }

        .candidate-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .candidate-salary {
            font-weight: 600;
            color: var(--dark);
        }

        .select-btn {
            background-color: white;
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .select-btn:hover {
            background-color: rgba(108, 99, 255, 0.1);
        }

        .select-btn.selected {
            background-color: var(--primary);
            color: white;
        }

        .load-more {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
        }

        .load-more-btn {
            background-color: white;
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 0.7rem 1.5rem;
            border-radius: 30px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .load-more-btn:hover {
            background-color: rgba(108, 99, 255, 0.1);
            transform: translateY(-2px);
        }

        /* Section de finalisation */
        .finalize-section {
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            padding: 2rem;
            text-align: center;
            margin-bottom: 3rem;
        }

        .finalize-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .finalize-desc {
            color: var(--text);
            max-width: 700px;
            margin: 0 auto 1.5rem;
            font-size: 1rem;
            line-height: 1.6;
        }

        .submit-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 30px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.7rem;
            box-shadow: var(--shadow-md);
        }

        .submit-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .submit-btn:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .progress-steps {
                width: 100%;
            }
            
            .step {
                padding: 0 1rem;
            }
            
            .step-text {
                font-size: 0.8rem;
            }
            
            .job-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .company-logo {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            
            .job-meta {
                justify-content: center;
            }
            
            .candidates-grid {
                grid-template-columns: 1fr;
            }
            
            .candidate-filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header></header>

    <main>
        <div class="selection-container">
            <div class="intro-section">
                <h1>Sélectionnez les candidats qui vous intéressent</h1>
                <p>Notre algorithme a analysé votre offre d'emploi et votre questionnaire pour vous proposer les meilleurs candidats. Sélectionnez les profils qui vous intéressent pour être mis en relation avec eux.</p>
            </div>

            <div class="progress-container">
                <div class="progress-steps">
                    <div class="progress-line"></div>
                    <div class="step completed">
                        <div class="step-circle"><i class="fas fa-check"></i></div>
                        <div class="step-text">Entreprise</div>
                    </div>
                    <div class="step completed">
                        <div class="step-circle"><i class="fas fa-check"></i></div>
                        <div class="step-text">Questionnaire</div>
                    </div>
                    <div class="step active">
                        <div class="step-circle">3</div>
                        <div class="step-text">Sélection</div>
                    </div>
                    <div class="step">
                        <div class="step-circle">4</div>
                        <div class="step-text">Matching</div>
                    </div>
                </div>
            </div>

            <div class="job-section">
                <div class="job-header">
                    <div class="company-logo">
                        T
                    </div>
                    <div class="job-info">
                        <h2 class="job-title">Développeur Frontend React</h2>
                        <p class="company-name">TechSolutions</p>
                        <div class="job-meta">
                            <div class="meta-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Paris, France</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-file-contract"></i>
                                <span>CDI</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-home"></i>
                                <span>Hybride</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-euro-sign"></i>
                                <span>55-65K€</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="job-skills">
                    <h3>Compétences requises</h3>
                    <div class="skills-container">
                        <span class="skill-tag">JavaScript</span>
                        <span class="skill-tag">React</span>
                        <span class="skill-tag">TypeScript</span>
                        <span class="skill-tag">HTML/CSS</span>
                        <span class="skill-tag">Redux</span>
                        <span class="skill-tag">Git</span>
                    </div>
                </div>
            </div>

            <div class="selection-counter">
                <div class="counter-text">Candidats sélectionnés</div>
                <div class="counter" id="selection-count">0/10</div>
            </div>

            <div class="candidates-section">
                <div class="section-header">
                    <h2 class="section-title">Candidats recommandés</h2>
                </div>

                <div class="candidate-filters">
                    <select class="filter-select" id="sort-filter">
                        <option value="match">Trier par correspondance</option>
                        <option value="experience">Trier par expérience</option>
                        <option value="availability">Trier par disponibilité</option>
                    </select>
                    <select class="filter-select" id="experience-filter">
                        <option value="all">Toutes les expériences</option>
                        <option value="junior">Junior (0-2 ans)</option>
                        <option value="mid">Confirmé (3-5 ans)</option>
                        <option value="senior">Senior (5+ ans)</option>
                    </select>
                    <select class="filter-select" id="availability-filter">
                        <option value="all">Toutes les disponibilités</option>
                        <option value="immediate">Immédiate</option>
                        <option value="one-month">1 mois ou moins</option>
                        <option value="more">Plus d'un mois</option>
                    </select>
                </div>

                <div class="candidates-grid" id="candidates-container">
                    <!-- Les candidats seront générés dynamiquement -->
                </div>

                <div class="load-more">
                    <button class="load-more-btn" id="load-more-btn">
                        <i class="fas fa-sync-alt"></i>
                        Afficher plus de candidats
                    </button>
                </div>
            </div>

            <div class="finalize-section">
                <h2 class="finalize-title">Prêt à rencontrer vos futurs collaborateurs ?</h2>
                <p class="finalize-desc">Vous avez sélectionné <span id="selected-count">0</span> candidats qui correspondent à votre offre. Validez votre sélection pour être mis en relation avec les candidats intéressés.</p>
                <button class="submit-btn" id="submit-btn" disabled>
                    <i class="fas fa-check-circle"></i>
                    Valider ma sélection
                </button>
            </div>
        </div>
    </main>

    <footer></footer>

    <script>
        // Données de l'offre d'emploi (simulées, à remplacer par les données réelles)
        let jobData = {
            title: "Développeur Frontend React",
            company: "TechSolutions",
            companyInitial: "T",
            location: "Paris, France",
            contract: "CDI",
            remote: "Hybride",
            salary: "55-65K€",
            skills: ["JavaScript", "React", "TypeScript", "HTML/CSS", "Redux", "Git"]
        };
        
        // Récupérer les données de l'offre depuis localStorage si disponibles
        const recruiterDataString = localStorage.getItem('recruiterFormData');
        if (recruiterDataString) {
            try {
                const recruiterData = JSON.parse(recruiterDataString);
                console.log("Données recruteur récupérées:", recruiterData);
                
                // Mettre à jour les données de l'offre avec les informations du recruteur
                if (recruiterData.job) {
                    jobData.title = recruiterData.job.title || jobData.title;
                }
                
                if (recruiterData.company) {
                    jobData.company = recruiterData.company.name || jobData.company;
                    jobData.location = recruiterData.company.formattedAddress || recruiterData.company.address || jobData.location;
                    
                    // Générer l'initiale de l'entreprise
                    if (recruiterData.company.name) {
                        jobData.companyInitial = recruiterData.company.name.charAt(0);
                    }
                }
                
                // Mettre à jour l'interface utilisateur avec les données récupérées
                updateJobInterface();
                
            } catch (error) {
                console.error("Erreur lors de la récupération des données recruteur:", error);
            }
        }
        
        // Mettre à jour l'interface utilisateur avec les données de l'offre
        function updateJobInterface() {
            document.querySelector('.company-logo').textContent = jobData.companyInitial;
            document.querySelector('.job-title').textContent = jobData.title;
            document.querySelector('.company-name').textContent = jobData.company;
            
            // Mettre à jour les méta-informations
            const metaItems = document.querySelectorAll('.meta-item span');
            metaItems[0].textContent = jobData.location;
            metaItems[1].textContent = jobData.contract;
            metaItems[2].textContent = jobData.remote;
            metaItems[3].textContent = jobData.salary;
            
            // Mettre à jour les compétences
            const skillsContainer = document.querySelector('.skills-container');
            skillsContainer.innerHTML = '';
            
            jobData.skills.forEach(skill => {
                const skillTag = document.createElement('span');
                skillTag.className = 'skill-tag';
                skillTag.textContent = skill;
                skillsContainer.appendChild(skillTag);
            });
        }
        
        // Données des candidats (simulées, à remplacer par les données réelles)
        const candidatesData = [
            {
                id: 1,
                name: "Jean Dupont",
                initials: "JD",
                title: "Développeur Frontend Senior",
                experience: "5 ans",
                location: "Paris",
                availability: "Disponible dans 2 mois",
                salary: "55-65K€",
                matchScore: 95,
                skills: ["JavaScript", "React", "TypeScript", "Node.js", "HTML/CSS", "Next.js"],
                softSkills: ["Communication", "Travail d'équipe", "Autonomie"],
                email: "jean.dupont@example.com"
            },
            {
                id: 2,
                name: "Marie Martin",
                initials: "MM",
                title: "Développeuse React",
                experience: "3 ans",
                location: "Paris",
                availability: "Disponible immédiatement",
                salary: "50-60K€",
                matchScore: 92,
                skills: ["JavaScript", "React", "Redux", "HTML/CSS", "TailwindCSS", "Jest"],
                softSkills: ["Résolution de problèmes", "Organisation", "Adaptabilité"],
                email: "marie.martin@example.com"
            },
            {
                id: 3,
                name: "Thomas Bernard",
                initials: "TB",
                title: "Développeur Frontend",
                experience: "4 ans",
                location: "Lyon",
                availability: "Disponible dans 1 mois",
                salary: "50-60K€",
                matchScore: 88,
                skills: ["JavaScript", "React", "Vue.js", "HTML/CSS", "Sass", "Webpack"],
                softSkills: ["Créativité", "Esprit d'équipe", "Communication"],
                email: "thomas.bernard@example.com"
            },
            {
                id: 4,
                name: "Sophie Petit",
                initials: "SP",
                title: "Développeuse Frontend/UI",
                experience: "2 ans",
                location: "Paris",
                availability: "Disponible dans 2 semaines",
                salary: "45-55K€",
                matchScore: 85,
                skills: ["JavaScript", "React", "HTML/CSS", "UI Design", "Figma", "Bootstrap"],
                softSkills: ["Créativité", "Souci du détail", "Autonomie"],
                email: "sophie.petit@example.com"
            },
            {
                id: 5,
                name: "Lucas Dubois",
                initials: "LD",
                title: "Développeur Full Stack",
                experience: "6 ans",
                location: "Remote",
                availability: "Disponible dans 3 mois",
                salary: "60-70K€",
                matchScore: 82,
                skills: ["JavaScript", "React", "Node.js", "Express", "MongoDB", "GraphQL"],
                softSkills: ["Leadership", "Communication", "Gestion de projet"],
                email: "lucas.dubois@example.com"
            },
            {
                id: 6,
                name: "Emma Leroy",
                initials: "EL",
                title: "Développeuse Frontend Junior",
                experience: "1 an",
                location: "Paris",
                availability: "Disponible immédiatement",
                salary: "40-45K€",
                matchScore: 78,
                skills: ["JavaScript", "React", "HTML/CSS", "Git", "Bootstrap"],
                softSkills: ["Apprentissage rapide", "Travail d'équipe", "Curiosité"],
                email: "emma.leroy@example.com"
            },
            {
                id: 7,
                name: "Alexandre Moreau",
                initials: "AM",
                title: "Développeur JavaScript Senior",
                experience: "7 ans",
                location: "Lyon",
                availability: "Disponible dans 1 mois",
                salary: "65-75K€",
                matchScore: 75,
                skills: ["JavaScript", "React", "Angular", "TypeScript", "Node.js", "Architecture"],
                softSkills: ["Leadership", "Mentorat", "Communication"],
                email: "alexandre.moreau@example.com"
            },
            {
                id: 8,
                name: "Julie Fournier",
                initials: "JF",
                title: "Développeuse React",
                experience: "3 ans",
                location: "Nantes",
                availability: "Disponible dans 1 mois",
                salary: "45-55K€",
                matchScore: 72,
                skills: ["JavaScript", "React", "Redux", "HTML/CSS", "Jest", "Git"],
                softSkills: ["Communication", "Autonomie", "Organisation"],
                email: "julie.fournier@example.com"
            },
            {
                id: 9,
                name: "Mathieu Blanc",
                initials: "MB",
                title: "Développeur Frontend Junior",
                experience: "1 an",
                location: "Paris",
                availability: "Disponible immédiatement",
                salary: "35-45K€",
                matchScore: 70,
                skills: ["JavaScript", "React", "HTML/CSS", "Responsive Design", "Git"],
                softSkills: ["Travail d'équipe", "Apprentissage rapide", "Adaptabilité"],
                email: "mathieu.blanc@example.com"
            },
            {
                id: 10,
                name: "Claire Mercier",
                initials: "CM",
                title: "Développeuse Full Stack",
                experience: "4 ans",
                location: "Remote",
                availability: "Disponible dans 2 mois",
                salary: "55-65K€",
                matchScore: 68,
                skills: ["JavaScript", "React", "Node.js", "Express", "PostgreSQL", "Docker"],
                softSkills: ["Résolution de problèmes", "Communication", "Autonomie"],
                email: "claire.mercier@example.com"
            }
        ];
        
        // Initialiser le compteur de sélection et l'ensemble des candidats sélectionnés
        let selectedCandidates = new Set();
        let displayedCandidates = 6; // Nombre de candidats affichés initialement
        
        // Générer les cartes de candidats
        function generateCandidateCards(candidates) {
            const candidatesContainer = document.getElementById('candidates-container');
            candidatesContainer.innerHTML = '';
            
            candidates.slice(0, displayedCandidates).forEach(candidate => {
                const isSelected = selectedCandidates.has(candidate.id);
                const cardClass = isSelected ? 'candidate-card selected' : 'candidate-card';
                const buttonClass = isSelected ? 'select-btn selected' : 'select-btn';
                const buttonText = isSelected ? '<i class="fas fa-check"></i> Sélectionné' : '<i class="fas fa-plus"></i> Sélectionner';
                
                let matchBadgeClass = 'match-badge';
                if (candidate.matchScore >= 90) {
                    matchBadgeClass += ' high';
                } else if (candidate.matchScore >= 80) {
                    matchBadgeClass += ' medium';
                }
                
                const candidateSkills = candidate.skills.map(skill => {
                    const isMatch = jobData.skills.includes(skill);
                    return `<span class="candidate-skill-tag${isMatch ? ' match' : ''}">${skill}</span>`;
                }).join('');
                
                const candidateCard = `
                    <div class="${cardClass}" data-id="${candidate.id}">
                        <div class="${matchBadgeClass}">${candidate.matchScore}% match</div>
                        <div class="candidate-header">
                            <div class="candidate-avatar">${candidate.initials}</div>
                            <div class="candidate-header-info">
                                <h3 class="candidate-name">${candidate.name}</h3>
                                <p class="candidate-title">${candidate.title}</p>
                                <div class="candidate-tags">
                                    <span class="candidate-tag"><i class="fas fa-briefcase"></i> ${candidate.experience}</span>
                                    <span class="candidate-tag"><i class="fas fa-map-marker-alt"></i> ${candidate.location}</span>
                                </div>
                            </div>
                        </div>
                        <div class="candidate-body">
                            <div class="meta-item" style="margin-bottom: 1rem;">
                                <i class="fas fa-calendar-check"></i>
                                <span>${candidate.availability}</span>
                            </div>
                            <div class="candidate-skills">
                                <p class="section-subtitle">Compétences techniques</p>
                                <div class="candidate-skill-tags">
                                    ${candidateSkills}
                                </div>
                            </div>
                            <div class="candidate-skills">
                                <p class="section-subtitle">Soft skills</p>
                                <div class="candidate-skill-tags">
                                    ${candidate.softSkills.map(skill => `<span class="candidate-skill-tag">${skill}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                        <div class="candidate-footer">
                            <div class="candidate-salary">${candidate.salary}</div>
                            <button class="${buttonClass}" data-id="${candidate.id}">${buttonText}</button>
                        </div>
                    </div>
                `;
                
                candidatesContainer.innerHTML += candidateCard;
            });
            
            // Ajouter les écouteurs d'événements pour les boutons de sélection
            document.querySelectorAll('.select-btn').forEach(button => {
                button.addEventListener('click', toggleCandidateSelection);
            });
        }
        
        // Fonction pour basculer la sélection d'un candidat
        function toggleCandidateSelection() {
            const candidateId = parseInt(this.getAttribute('data-id'));
            const candidateCard = document.querySelector(`.candidate-card[data-id="${candidateId}"]`);
            
            if (selectedCandidates.has(candidateId)) {
                // Désélectionner le candidat
                selectedCandidates.delete(candidateId);
                candidateCard.classList.remove('selected');
                this.classList.remove('selected');
                this.innerHTML = '<i class="fas fa-plus"></i> Sélectionner';
            } else {
                // Vérifier si le maximum de sélections est atteint
                if (selectedCandidates.size >= 10) {
                    alert('Vous avez déjà sélectionné 10 candidats, le maximum autorisé. Veuillez en désélectionner un avant d\'en ajouter un nouveau.');
                    return;
                }
                
                // Sélectionner le candidat
                selectedCandidates.add(candidateId);
                candidateCard.classList.add('selected');
                this.classList.add('selected');
                this.innerHTML = '<i class="fas fa-check"></i> Sélectionné';
            }
            
            // Mettre à jour les compteurs
            updateSelectionCounters();
            
            // Activer/désactiver le bouton de soumission
            document.getElementById('submit-btn').disabled = selectedCandidates.size === 0;
        }
        
        // Mettre à jour les compteurs de sélection
        function updateSelectionCounters() {
            document.getElementById('selection-count').textContent = `${selectedCandidates.size}/10`;
            document.getElementById('selected-count').textContent = selectedCandidates.size;
        }
        
        // Gérer le bouton "Afficher plus"
        document.getElementById('load-more-btn').addEventListener('click', function() {
            // Augmenter le nombre de candidats affichés
            displayedCandidates = Math.min(displayedCandidates + 4, candidatesData.length);
            
            // Regénérer les cartes de candidats
            generateCandidateCards(getSortedAndFilteredCandidates());
            
            // Masquer le bouton si tous les candidats sont affichés
            if (displayedCandidates >= candidatesData.length) {
                this.style.display = 'none';
            }
        });
        
        // Gérer les filtres et le tri
        document.getElementById('sort-filter').addEventListener('change', applyFiltersAndSort);
        document.getElementById('experience-filter').addEventListener('change', applyFiltersAndSort);
        document.getElementById('availability-filter').addEventListener('change', applyFiltersAndSort);
        
        function applyFiltersAndSort() {
            // Réinitialiser le nombre de candidats affichés
            displayedCandidates = 6;
            
            // Afficher les candidats filtrés et triés
            generateCandidateCards(getSortedAndFilteredCandidates());
            
            // Afficher le bouton "Afficher plus" s'il reste des candidats à afficher
            const loadMoreBtn = document.getElementById('load-more-btn');
            loadMoreBtn.style.display = candidatesData.length > displayedCandidates ? 'flex' : 'none';
        }
        
        function getSortedAndFilteredCandidates() {
            // Récupérer les valeurs des filtres
            const sortValue = document.getElementById('sort-filter').value;
            const experienceValue = document.getElementById('experience-filter').value;
            const availabilityValue = document.getElementById('availability-filter').value;
            
            // Filtrer les candidats
            let filteredCandidates = [...candidatesData];
            
            if (experienceValue !== 'all') {
                filteredCandidates = filteredCandidates.filter(candidate => {
                    const years = parseInt(candidate.experience);
                    if (experienceValue === 'junior') return years <= 2;
                    if (experienceValue === 'mid') return years >= 3 && years <= 5;
                    if (experienceValue === 'senior') return years >= 5;
                    return true;
                });
            }
            
            if (availabilityValue !== 'all') {
                filteredCandidates = filteredCandidates.filter(candidate => {
                    if (availabilityValue === 'immediate') return candidate.availability.includes('immédiatement');
                    if (availabilityValue === 'one-month') {
                        return candidate.availability.includes('semaine') || 
                               (candidate.availability.includes('mois') && candidate.availability.includes('1'));
                    }
                    if (availabilityValue === 'more') {
                        return !candidate.availability.includes('immédiatement') && 
                               !candidate.availability.includes('semaine') && 
                               !(candidate.availability.includes('mois') && candidate.availability.includes('1'));
                    }
                    return true;
                });
            }
            
            // Trier les candidats
            filteredCandidates.sort((a, b) => {
                if (sortValue === 'match') return b.matchScore - a.matchScore;
                if (sortValue === 'experience') {
                    const expA = parseInt(a.experience);
                    const expB = parseInt(b.experience);
                    return expB - expA;
                }
                if (sortValue === 'availability') {
                    const getAvailabilityValue = (availability) => {
                        if (availability.includes('immédiatement')) return 0;
                        if (availability.includes('semaine')) return 1;
                        if (availability.includes('1 mois')) return 2;
                        if (availability.includes('2 mois')) return 3;
                        if (availability.includes('3 mois')) return 4;
                        return 5;
                    };
                    return getAvailabilityValue(a.availability) - getAvailabilityValue(b.availability);
                }
                return 0;
            });
            
            return filteredCandidates;
        }
        
        // Gérer le bouton de soumission
        document.getElementById('submit-btn').addEventListener('click', function() {
            if (selectedCandidates.size === 0) {
                alert('Veuillez sélectionner au moins un candidat avant de valider.');
                return;
            }
            
            // Récupérer les candidats sélectionnés
            const selectedCandidatesArray = Array.from(selectedCandidates).map(id => {
                return candidatesData.find(candidate => candidate.id === id);
            });
            
            // Sauvegarder les candidats sélectionnés dans localStorage
            localStorage.setItem('selectedCandidates', JSON.stringify(selectedCandidatesArray));
            
            // Rediriger vers la page de matching
            window.location.href = 'recruiter-matches.html';
        });
        
        // Afficher les candidats au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            // Mettre à jour l'interface utilisateur avec les données de l'offre
            updateJobInterface();
            
            // Générer les cartes de candidats
            generateCandidateCards(candidatesData);
            
            // Initialiser les compteurs de sélection
            updateSelectionCounters();
            
            // Désactiver le bouton de soumission au départ
            document.getElementById('submit-btn').disabled = true;
            
            // Afficher le bouton "Afficher plus" s'il reste des candidats à afficher
            document.getElementById('load-more-btn').style.display = candidatesData.length > displayedCandidates ? 'flex' : 'none';
        });
    </script>
</body>
</html>