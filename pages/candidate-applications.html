<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi des candidatures - Nexten</title>
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .applications-section {
            padding: 4rem 0;
            background-color: var(--light);
        }
        
        .section-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -10px;
            width: 40px;
            height: 3px;
            background-color: var(--primary);
            border-radius: 4px;
        }
        
        .section-description {
            color: var(--text);
            margin: 1.5rem 0 2.5rem;
            max-width: 700px;
        }
        
        .applications-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .application-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }
        
        .stat-card {
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: var(--text);
            font-weight: 500;
        }
        
        .applications-filters {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .filter-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .filter-label {
            font-weight: 500;
            color: var(--dark);
        }
        
        .filter-select {
            padding: 0.6rem 1rem;
            border: 1px solid var(--gray);
            border-radius: var(--radius);
            background-color: white;
            color: var(--dark);
        }
        
        .search-section {
            position: relative;
            flex-grow: 1;
            max-width: 400px;
        }
        
        .search-input {
            width: 100%;
            padding: 0.6rem 1rem 0.6rem 2.5rem;
            border: 1px solid var(--gray);
            border-radius: var(--radius);
            background-color: white;
        }
        
        .search-icon {
            position: absolute;
            left: 0.8rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text);
        }
        
        .applications-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 0.8rem;
        }
        
        .application-row {
            background-color: white;
            box-shadow: var(--shadow-sm);
            border-radius: var(--radius);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .application-row:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .application-row td {
            padding: 1.2rem 1rem;
            vertical-align: middle;
        }
        
        .application-row td:first-child {
            border-top-left-radius: var(--radius);
            border-bottom-left-radius: var(--radius);
        }
        
        .application-row td:last-child {
            border-top-right-radius: var(--radius);
            border-bottom-right-radius: var(--radius);
        }
        
        .company-logo {
            width: 50px;
            height: 50px;
            background-color: var(--light);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        .application-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.3rem;
        }
        
        .application-company {
            color: var(--text);
            font-size: 0.9rem;
        }
        
        .application-date {
            color: var(--text);
            font-size: 0.9rem;
        }
        
        .application-status {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 500;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .status-submitted {
            background-color: rgba(108, 99, 255, 0.1);
            color: var(--primary);
        }
        
        .status-viewed {
            background-color: rgba(100, 116, 139, 0.1);
            color: #64748b;
        }
        
        .status-interview {
            background-color: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
        }
        
        .status-offer {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .status-rejected {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .application-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
        
        .action-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--light);
            color: var(--text);
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        
        .action-btn:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .action-btn i {
            font-size: 0.9rem;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
            gap: 0.5rem;
        }
        
        .pagination-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            background-color: white;
            color: var(--text);
            border: 1px solid var(--gray);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .pagination-btn:hover, .pagination-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .pagination-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pagination-btn.disabled:hover {
            background-color: white;
            color: var(--text);
            border-color: var(--gray);
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
        }
        
        .empty-state i {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 1rem;
        }
        
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }
        
        .empty-state p {
            color: var(--text);
            margin-bottom: 1.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .empty-state-action {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background-color: var(--primary);
            color: white;
            border-radius: 30px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s ease;
        }
        
        .empty-state-action:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(108, 99, 255, 0.4);
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow: auto;
        }
        
        .modal-content {
            position: relative;
            background-color: white;
            margin: 10% auto;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            animation: modalIn 0.3s ease-out;
        }
        
        @keyframes modalIn {
            0% { opacity: 0; transform: translateY(-20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: var(--light);
            color: var(--text);
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        
        .modal-close:hover {
            background-color: var(--gray);
            color: var(--dark);
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray);
        }
        
        .modal-body {
            margin-bottom: 1.5rem;
        }
        
        .modal-section {
            margin-bottom: 1.5rem;
        }
        
        .modal-section-title {
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: var(--dark);
        }
        
        .modal-section-content {
            color: var(--text);
            line-height: 1.5;
        }
        
        .modal-section-content.details {
            background-color: var(--light);
            padding: 1rem;
            border-radius: var(--radius);
        }
        
        .detail-item {
            display: flex;
            margin-bottom: 0.5rem;
        }
        
        .detail-label {
            width: 100px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .detail-value {
            flex: 1;
        }
        
        .timeline {
            position: relative;
            padding-left: 2rem;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: var(--gray);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .timeline-item:last-child {
            margin-bottom: 0;
        }
        
        .timeline-dot {
            position: absolute;
            left: -2rem;
            top: 2px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--primary);
            border: 3px solid white;
            z-index: 1;
        }
        
        .timeline-content {
            background-color: white;
            padding: 1rem;
            border-radius: var(--radius);
            border-left: 3px solid var(--primary);
            box-shadow: var(--shadow-sm);
        }
        
        .timeline-date {
            display: block;
            font-size: 0.8rem;
            color: var(--text);
            margin-bottom: 0.3rem;
        }
        
        .timeline-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.3rem;
        }
        
        .timeline-description {
            font-size: 0.9rem;
            color: var(--text);
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .applications-filters {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .filter-section, .search-section {
                width: 100%;
                max-width: none;
            }
            
            .applications-table, .applications-table tbody, .applications-table tr, .applications-table td {
                display: block;
                width: 100%;
            }
            
            .applications-table tr {
                margin-bottom: 1rem;
                position: relative;
                padding-bottom: 60px; /* Space for actions */
            }
            
            .applications-table td {
                padding: 0.8rem;
                text-align: left;
                border: none;
            }
            
            .applications-table td:first-child {
                display: flex;
                align-items: center;
                gap: 1rem;
            }
            
            .application-actions {
                position: absolute;
                bottom: 1rem;
                right: 1rem;
            }
            
            .responsive-hide {
                display: none;
            }
            
            .responsive-label {
                display: inline-block;
                font-weight: 600;
                margin-right: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <!-- Le header sera chargé par JavaScript -->
    </header>

    <main>
        <section class="applications-section">
            <div class="container">
                <h2 class="section-title">Mes candidatures</h2>
                <p class="section-description">Suivez l'évolution de vos candidatures et restez informé des prochaines étapes du processus de recrutement.</p>
                
                <div class="applications-container">
                    <div class="application-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="total-applications">0</div>
                            <div class="stat-label">Candidatures totales</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="active-applications">0</div>
                            <div class="stat-label">Candidatures actives</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="interview-applications">0</div>
                            <div class="stat-label">Entretiens</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="offer-applications">0</div>
                            <div class="stat-label">Offres reçues</div>
                        </div>
                    </div>
                    
                    <div class="applications-filters">
                        <div class="filter-section">
                            <div class="filter-label">Status :</div>
                            <select id="status-filter" class="filter-select">
                                <option value="all">Tout</option>
                                <option value="submitted">Candidature envoyée</option>
                                <option value="viewed">CV consulté</option>
                                <option value="interview">Entretien</option>
                                <option value="offer">Offre reçue</option>
                                <option value="rejected">Refusée</option>
                            </select>
                        </div>
                        
                        <div class="filter-section">
                            <div class="filter-label">Trier par :</div>
                            <select id="sort-filter" class="filter-select">
                                <option value="date-desc">Date (plus récent)</option>
                                <option value="date-asc">Date (plus ancien)</option>
                                <option value="company">Entreprise</option>
                                <option value="title">Poste</option>
                            </select>
                        </div>
                        
                        <div class="search-section">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" id="search-input" class="search-input" placeholder="Rechercher par poste ou entreprise...">
                        </div>
                    </div>
                    
                    <div id="applications-table-container">
                        <table class="applications-table">
                            <thead style="display: none;">
                                <tr>
                                    <th>Poste</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="applications-table-body">
                                <!-- Les données des candidatures seront générées ici par JavaScript -->
                            </tbody>
                        </table>
                        
                        <!-- État vide (affiché s'il n'y a pas de candidatures) -->
                        <div id="empty-state" class="empty-state" style="display: none;">
                            <i class="fas fa-file-alt"></i>
                            <h3>Aucune candidature</h3>
                            <p>Vous n'avez pas encore de candidature en cours. Explorez notre sélection d'offres recommandées pour trouver votre prochain emploi.</p>
                            <a href="candidate-matches.html" class="empty-state-action">Voir les offres recommandées</a>
                        </div>
                    </div>
                    
                    <!-- Pagination -->
                    <div class="pagination" id="pagination">
                        <!-- Les boutons de pagination seront générés ici par JavaScript -->
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Modal de détails de candidature -->
    <div id="application-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">
                <i class="fas fa-times"></i>
            </button>
            <h3 class="modal-title" id="modal-title">Détails de candidature</h3>
            <div class="modal-body">
                <!-- Informations sur le poste -->
                <div class="modal-section">
                    <h4 class="modal-section-title">Informations sur le poste</h4>
                    <div class="modal-section-content details">
                        <div class="detail-item">
                            <div class="detail-label">Entreprise :</div>
                            <div class="detail-value" id="modal-company">Nom de l'entreprise</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Poste :</div>
                            <div class="detail-value" id="modal-job">Titre du poste</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Statut :</div>
                            <div class="detail-value" id="modal-status">Statut de la candidature</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Postulé le :</div>
                            <div class="detail-value" id="modal-date">Date de candidature</div>
                        </div>
                    </div>
                </div>
                
                <!-- Historique de la candidature -->
                <div class="modal-section">
                    <h4 class="modal-section-title">Historique</h4>
                    <div class="modal-section-content">
                        <div class="timeline" id="modal-timeline">
                            <!-- L'historique sera généré ici par JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="modal-section">
                    <h4 class="modal-section-title">Actions</h4>
                    <div class="modal-section-content">
                        <button id="modal-action-btn" class="btn btn-primary" style="width: 100%;">Contacter le recruteur</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <!-- Le footer sera chargé par JavaScript -->
    </footer>

    <script src="../components/header.js"></script>
    <script src="../components/footer.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Éléments DOM
            const totalApplicationsEl = document.getElementById('total-applications');
            const activeApplicationsEl = document.getElementById('active-applications');
            const interviewApplicationsEl = document.getElementById('interview-applications');
            const offerApplicationsEl = document.getElementById('offer-applications');
            const applicationsTableBody = document.getElementById('applications-table-body');
            const emptyState = document.getElementById('empty-state');
            const paginationContainer = document.getElementById('pagination');
            
            // Filtres
            const statusFilter = document.getElementById('status-filter');
            const sortFilter = document.getElementById('sort-filter');
            const searchInput = document.getElementById('search-input');
            
            // Modal
            const applicationModal = document.getElementById('application-modal');
            const modalClose = document.getElementById('modal-close');
            const modalTitle = document.getElementById('modal-title');
            const modalCompany = document.getElementById('modal-company');
            const modalJob = document.getElementById('modal-job');
            const modalStatus = document.getElementById('modal-status');
            const modalDate = document.getElementById('modal-date');
            const modalTimeline = document.getElementById('modal-timeline');
            const modalActionBtn = document.getElementById('modal-action-btn');
            
            // Variables de pagination
            let currentPage = 1;
            const itemsPerPage = 5;
            let filteredApplications = [];
            
            // Récupérer les candidatures depuis localStorage
            function loadApplications() {
                try {
                    const applications = JSON.parse(localStorage.getItem('candidateApplications') || '[]');
                    return applications;
                } catch (error) {
                    console.error('Erreur lors du chargement des candidatures:', error);
                    return [];
                }
            }
            
            // Initialiser les statistiques
            function updateStats(applications) {
                const total = applications.length;
                const active = applications.filter(app => app.status !== 'rejected' && app.status !== 'offer').length;
                const interviews = applications.filter(app => app.status === 'interview').length;
                const offers = applications.filter(app => app.status === 'offer').length;
                
                totalApplicationsEl.textContent = total;
                activeApplicationsEl.textContent = active;
                interviewApplicationsEl.textContent = interviews;
                offerApplicationsEl.textContent = offers;
            }
            
            // Filtrer les candidatures
            function filterApplications(applications) {
                const statusValue = statusFilter.value;
                const searchValue = searchInput.value.toLowerCase().trim();
                
                // Filtrer par statut
                let filtered = applications;
                if (statusValue !== 'all') {
                    filtered = filtered.filter(app => app.status === statusValue);
                }
                
                // Filtrer par recherche
                if (searchValue) {
                    filtered = filtered.filter(app => 
                        app.jobTitle.toLowerCase().includes(searchValue) || 
                        app.company.toLowerCase().includes(searchValue)
                    );
                }
                
                return filtered;
            }
            
            // Trier les candidatures
            function sortApplications(applications) {
                const sortValue = sortFilter.value;
                
                let sorted = [...applications];
                switch (sortValue) {
                    case 'date-desc':
                        sorted.sort((a, b) => new Date(b.applyDate) - new Date(a.applyDate));
                        break;
                    case 'date-asc':
                        sorted.sort((a, b) => new Date(a.applyDate) - new Date(b.applyDate));
                        break;
                    case 'company':
                        sorted.sort((a, b) => a.company.localeCompare(b.company));
                        break;
                    case 'title':
                        sorted.sort((a, b) => a.jobTitle.localeCompare(b.jobTitle));
                        break;
                    default:
                        sorted.sort((a, b) => new Date(b.applyDate) - new Date(a.applyDate));
                }
                
                return sorted;
            }
            
            // Formater une date
            function formatDate(dateString) {
                if (!dateString) return '';
                
                const date = new Date(dateString);
                return new Intl.DateTimeFormat('fr-FR', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }).format(date);
            }
            
            // Obtenir le statut formaté
            function getStatusText(status) {
                const statusMap = {
                    'submitted': 'Candidature envoyée',
                    'viewed': 'CV consulté',
                    'interview': 'Entretien',
                    'offer': 'Offre reçue',
                    'rejected': 'Refusée'
                };
                
                return statusMap[status] || status;
            }
            
            // Gérer la pagination
            function handlePagination(applications) {
                // Calculer le nombre de pages
                const totalPages = Math.ceil(applications.length / itemsPerPage);
                
                // Ajuster la page courante si nécessaire
                if (currentPage > totalPages) {
                    currentPage = Math.max(1, totalPages);
                }
                
                // Calculer les indices de début et de fin
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                
                // Obtenir les éléments pour la page courante
                return applications.slice(startIndex, endIndex);
            }
            
            // Mettre à jour la pagination
            function updatePagination(applications) {
                const totalPages = Math.ceil(applications.length / itemsPerPage);
                paginationContainer.innerHTML = '';
                
                // N'afficher la pagination que s'il y a plus d'une page
                if (totalPages <= 1) {
                    return;
                }
                
                // Bouton précédent
                const prevButton = document.createElement('button');
                prevButton.className = `pagination-btn ${currentPage === 1 ? 'disabled' : ''}`;
                prevButton.innerHTML = '<i class="fas fa-chevron-left"></i>';
                prevButton.disabled = currentPage === 1;
                prevButton.addEventListener('click', () => {
                    if (currentPage > 1) {
                        currentPage--;
                        displayApplications();
                    }
                });
                paginationContainer.appendChild(prevButton);
                
                // Boutons de pages
                const maxVisiblePages = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
                let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
                
                if (endPage - startPage + 1 < maxVisiblePages) {
                    startPage = Math.max(1, endPage - maxVisiblePages + 1);
                }
                
                for (let i = startPage; i <= endPage; i++) {
                    const pageButton = document.createElement('button');
                    pageButton.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
                    pageButton.textContent = i.toString();
                    pageButton.addEventListener('click', () => {
                        currentPage = i;
                        displayApplications();
                    });
                    paginationContainer.appendChild(pageButton);
                }
                
                // Bouton suivant
                const nextButton = document.createElement('button');
                nextButton.className = `pagination-btn ${currentPage === totalPages ? 'disabled' : ''}`;
                nextButton.innerHTML = '<i class="fas fa-chevron-right"></i>';
                nextButton.disabled = currentPage === totalPages;
                nextButton.addEventListener('click', () => {
                    if (currentPage < totalPages) {
                        currentPage++;
                        displayApplications();
                    }
                });
                paginationContainer.appendChild(nextButton);
            }
            
            // Afficher les candidatures
            function displayApplications() {
                // Charger les candidatures
                const applications = loadApplications();
                
                // Mettre à jour les statistiques
                updateStats(applications);
                
                // Afficher l'état vide s'il n'y a pas de candidatures
                if (applications.length === 0) {
                    emptyState.style.display = 'block';
                    applicationsTableBody.innerHTML = '';
                    paginationContainer.innerHTML = '';
                    return;
                }
                
                // Filtrer et trier les candidatures
                filteredApplications = sortApplications(filterApplications(applications));
                
                // Gérer l'état vide pour les résultats filtrés
                if (filteredApplications.length === 0) {
                    emptyState.style.display = 'block';
                    emptyState.querySelector('h3').textContent = 'Aucun résultat';
                    emptyState.querySelector('p').textContent = 'Aucune candidature ne correspond à vos critères de recherche.';
                    applicationsTableBody.innerHTML = '';
                    paginationContainer.innerHTML = '';
                    return;
                }
                
                // Masquer l'état vide
                emptyState.style.display = 'none';
                
                // Paginer les candidatures
                const paginatedApplications = handlePagination(filteredApplications);
                
                // Mettre à jour la pagination
                updatePagination(filteredApplications);
                
                // Vider le tableau
                applicationsTableBody.innerHTML = '';
                
                // Ajouter les candidatures au tableau
                paginatedApplications.forEach(application => {
                    const row = document.createElement('tr');
                    row.className = 'application-row';
                    row.setAttribute('data-id', application.id);
                    
                    // Formater le statut
                    const statusClass = `status-${application.status}`;
                    const statusText = getStatusText(application.status);
                    
                    // Formater la date
                    const applyDate = formatDate(application.applyDate);
                    
                    // Construire la ligne
                    row.innerHTML = `
                        <td>
                            <div class="company-logo">${application.company.charAt(0)}</div>
                            <div style="padding-left: 0.8rem;">
                                <div class="application-title">${application.jobTitle}</div>
                                <div class="application-company">${application.company}</div>
                            </div>
                        </td>
                        <td class="responsive-hide">
                            <div class="application-date">${applyDate}</div>
                        </td>
                        <td>
                            <span class="responsive-label">Statut:</span>
                            <span class="application-status ${statusClass}">${statusText}</span>
                        </td>
                        <td>
                            <div class="application-actions">
                                <button class="action-btn view-details" data-id="${application.id}" title="Voir les détails">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn contact-recruiter" data-id="${application.id}" title="Contacter le recruteur">
                                    <i class="fas fa-comment"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    applicationsTableBody.appendChild(row);
                });
                
                // Ajouter les écouteurs d'événements pour les boutons d'action
                document.querySelectorAll('.view-details').forEach(button => {
                    button.addEventListener('click', function() {
                        const applicationId = this.getAttribute('data-id');
                        openApplicationDetails(applicationId);
                    });
                });
                
                document.querySelectorAll('.contact-recruiter').forEach(button => {
                    button.addEventListener('click', function() {
                        const applicationId = this.getAttribute('data-id');
                        contactRecruiter(applicationId);
                    });
                });
                
                // Ajouter un écouteur d'événements pour les lignes du tableau
                document.querySelectorAll('.application-row').forEach(row => {
                    row.addEventListener('click', function(e) {
                        // Ne pas déclencher si le clic est sur un bouton d'action
                        if (!e.target.closest('.action-btn')) {
                            const applicationId = this.getAttribute('data-id');
                            openApplicationDetails(applicationId);
                        }
                    });
                });
            }
            
            // Ouvrir la modal de détails de candidature
            function openApplicationDetails(applicationId) {
                // Trouver la candidature dans la liste filtrée
                const application = filteredApplications.find(app => app.id == applicationId);
                if (!application) return;
                
                // Mettre à jour le contenu de la modal
                modalTitle.textContent = `Candidature : ${application.jobTitle}`;
                modalCompany.textContent = application.company;
                modalJob.textContent = application.jobTitle;
                modalStatus.textContent = getStatusText(application.status);
                modalStatus.className = `status-${application.status}`;
                modalDate.textContent = formatDate(application.applyDate);
                
                // Mettre à jour l'historique
                modalTimeline.innerHTML = '';
                
                if (application.history && application.history.length > 0) {
                    application.history.forEach(event => {
                        const timelineItem = document.createElement('div');
                        timelineItem.className = 'timeline-item';
                        
                        timelineItem.innerHTML = `
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <span class="timeline-date">${formatDate(event.date)}</span>
                                <div class="timeline-title">${getStatusText(event.status)}</div>
                                <div class="timeline-description">${event.note || 'Aucune note'}</div>
                            </div>
                        `;
                        
                        modalTimeline.appendChild(timelineItem);
                    });
                } else {
                    modalTimeline.innerHTML = '<p>Aucun historique disponible</p>';
                }
                
                // Mettre à jour le bouton d'action
                modalActionBtn.textContent = 'Contacter le recruteur';
                modalActionBtn.onclick = () => contactRecruiter(applicationId);
                
                // Afficher la modal
                applicationModal.style.display = 'block';
                
                // Ajouter un gestionnaire pour fermer la modal
                modalClose.onclick = () => {
                    applicationModal.style.display = 'none';
                };
                
                // Fermer la modal en cliquant en dehors
                window.addEventListener('click', function(event) {
                    if (event.target === applicationModal) {
                        applicationModal.style.display = 'none';
                    }
                });
            }
            
            // Contacter le recruteur
            function contactRecruiter(applicationId) {
                // Trouver la candidature
                const applications = loadApplications();
                const application = applications.find(app => app.id == applicationId);
                if (!application) return;
                
                // Simuler l'envoi d'un message
                alert(`Fonctionnalité en développement: Contacter le recruteur pour la candidature "${application.jobTitle}" chez ${application.company}`);
            }
            
            // Ajouter les écouteurs d'événements pour les filtres
            statusFilter.addEventListener('change', function() {
                currentPage = 1; // Réinitialiser la pagination
                displayApplications();
            });
            
            sortFilter.addEventListener('change', function() {
                displayApplications();
            });
            
            searchInput.addEventListener('input', function() {
                currentPage = 1; // Réinitialiser la pagination
                displayApplications();
            });
            
            // Initialiser l'affichage des candidatures
            displayApplications();
        });
    </script>
</body>
</html>